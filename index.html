<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Terry’s 커피빈 노트 ☕</title>

  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#d2b48c" />
</head>
<body>

  <!-- 🔒 잠금 화면 -->
  <div id="lockScreen" class="lock-screen">
    <div class="lock-card">
      <h1 class="lock-title">접근 권한 확인</h1>
      <p class="lock-desc">
        개인 전용 커피 노트입니다.<br/>
        비밀번호를 입력해야 열람할 수 있습니다.
      </p>

      <div class="form-group">
        <label>비밀번호</label>
        <input id="unlockPassword" type="password" placeholder="비밀번호를 입력하세요" />
      </div>

      <button id="unlockButton" class="unlock-btn">열기</button>

      <p class="lock-hint">허가받지 않은 사용자는 접근할 수 없습니다.</p>
      <p class="lock-error" id="lockError" style="display:none;">
        비밀번호가 틀렸습니다.
      </p>
    </div>
  </div>

  <!-- 🔓 앱 본체 (잠금 해제 후에만 보임) -->
  <div id="appWrapper" class="app-wrapper" style="display:none;">

    <!-- 상단 헤더 / 탭 네비게이션 -->
    <header>
      <h1>Terry’s 커피빈 노트 ☕</h1>
      <p class="subtitle">공유 커피 빈 기록 · 실시간 동기화</p>

      <nav class="tab-nav">
        <button id="tabWrite" class="tab-btn tab-active">기록하기</button>
        <button id="tabList" class="tab-btn">리스트</button>
      </nav>
    </header>

    <main>
      <!-- ✍ 기록하기 페이지 -->
      <section id="pageWrite" class="page-section">
        <div class="card">
          <h2>새 원두 기록하기</h2>

          <!-- 커피 이름 -->
          <div class="form-group">
            <label>원두 이름 (커피 이름)</label>
            <input id="beanName" type="text" placeholder="예: Ethiopia Yirgacheffe G1 Washed" />
          </div>

          <!-- 브랜드/로스터리 -->
          <div class="form-group">
            <label>브랜드 / 로스터리</label>
            <input id="beanBrand" type="text" placeholder="예: Blue Bottle, Fritz Coffee, Onyx…" />
          </div>

          <div class="form-group">
            <label>로스팅 정도</label>
            <select id="roastLevel">
              <option value="">선택해주세요</option>
              <option>Light</option>
              <option>Medium</option>
              <option>Dark</option>
            </select>
          </div>

          <!-- 산미 / 바디 -->
          <div class="form-row">
            <div class="form-group small">
              <label>산미 (1~5)</label>
              <input id="acidity" type="number" min="1" max="5" placeholder="3" />
            </div>

            <div class="form-group small">
              <label>바디 (무게감, 1~5)</label>
              <input id="body" type="number" min="1" max="5" placeholder="4" />
            </div>
          </div>

          <!-- 평점 -->
          <div class="form-row">
            <div class="form-group small">
              <label>평점 (1~10)</label>
              <input id="rating" type="number" min="1" max="10" placeholder="예: 8" />
            </div>
          </div>

          <div class="form-group">
            <label>향 / 노트</label>
            <input id="flavorNotes" type="text" placeholder="예: 꽃향, 복숭아, 초콜릿, 너트…" />
          </div>

          <div class="form-group">
            <label>내 메모</label>
            <textarea id="myNotes" rows="3" placeholder="첫 모금은 복숭아 느낌, 끝에 초콜릿 단맛 남음 등"></textarea>
          </div>

          <!-- 이미지 첨부 -->
          <div class="form-group">
            <label>패키지 사진 (라벨/봉투 등)</label>
            <input
              id="beanImage"
              type="file"
              accept="image/*"
              capture="environment"
            />
            <p class="hint-text">
              스마트폰 앨범에서 선택하거나 바로 촬영 가능합니다.
              저장 시 512x512로 맞춰서 기록돼요.
            </p>

            <div class="preview-wrapper">
              <img id="imagePreview" class="preview-image" src="" alt="미리보기" style="display:none;" />
            </div>
          </div>

          <div class="button-row">
            <button id="saveButton">저장하기</button>
            <button id="updateButton" style="display:none;">수정 완료</button>
          </div>
        </div>
      </section>

      <!-- 📋 리스트 / 필터 페이지 -->
      <section id="pageList" class="page-section" style="display:none;">

        <div class="card">
          <h2>필터</h2>

          <div class="form-group">
            <label>브랜드로 검색</label>
            <input id="filterBrand" type="text" placeholder="예: Fritz, Onyx…" />
          </div>

          <div class="form-row">
            <div class="form-group small">
              <label>산미 (정확히 이 값)</label>
              <input id="filterAcidity" type="number" min="1" max="5" placeholder="예: 3" />
            </div>

            <div class="form-group small">
              <label>바디 (정확히 이 값)</label>
              <input id="filterBody" type="number" min="1" max="5" placeholder="예: 4" />
            </div>
          </div>

          <div class="button-row">
            <button id="applyFilterButton">필터 적용</button>
            <button id="clearFilterButton">필터 초기화</button>
          </div>
        </div>

        <section>
          <h2>저장된 원두 목록</h2>
          <div id="filteredList" class="list-area"></div>
        </section>

        <!-- 📦 백업 / 복원 / 이메일 전송 -->
        <div class="card">
          <h2>📦 백업 & 복원</h2>
          <p class="hint-text">
            저장된 모든 원두 데이터를 JSON 파일로 내보내거나 복원할 수 있습니다.
            (지금은 Firebase와 동기화됩니다)
          </p>

          <div class="button-row">
            <button id="exportButton">백업 내보내기</button>
            <button id="importButton">복원 불러오기</button>
          </div>

          <input type="file" id="importFileInput" accept=".json" style="display:none;" />

          <div class="button-row" style="margin-top:10px;">
            <button id="emailBackupButton">이메일로 백업 보내기</button>
          </div>
        </div>

      </section>
    </main>

    <footer>
      <p>Terry’s 커피빈 노트 ☕</p>
    </footer>
  </div>

  <!-- Firebase SDK (Compat 버전: 브라우저에서 바로 사용하기 쉬움) -->
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/11.0.0/firebase-database-compat.js"></script>

  <script>
    // 🔥 여기에 너의 Firebase 프로젝트 설정값을 넣어야 해
    // Firebase 콘솔 > 프로젝트 설정 > 내 앱(웹) > 구성에서 복사한 값
    const firebaseConfig = {
      apiKey: "AIzaSyB7dGT3ZdOywZku5S_T_pKyiJuqD_yDSDo",
      authDomain: "terry-s-coffee-bean-note.firebaseapp.com",
      projectId: "terry-s-coffee-bean-note",
      storageBucket: "terry-s-coffee-bean-note.firebasestorage.app",
      messagingSenderId: "617879496307",
      appId: "1:617879496307:web:d1fc8ef599f6c19b78ac06",
      measurementId: "G-LCBLTKFCT8"
    };

    // Firebase 시작
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
  </script>

  <script src="app.js"></script>
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./service-worker.js");
    }
  </script>
</body>
</html>
